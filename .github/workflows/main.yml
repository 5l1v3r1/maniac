name: CMake Build

on: [push]

jobs:
  build-ubuntu:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v1
    - name: Configure
      run: sudo apt install libxtst-dev && mkdir build && cd build && ..
    - name: Build
      run: cmake --build build && mkdir artifact && mv build/maniac artifact
    - name: Upload artifact
      uses: actions/upload-artifact@v1.0.0
      with:
        name: build-ubuntu-latest
        path: artifact

  build-windows:

    runs-on: windows-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: Configure
      run:  export PATH=${PATH%:C:/Program Files/Git/usr/bin/sh.exe} && mkdir build && cd build && cmake .. -G "MinGW Makefiles"
      shell: bash
    - name: Build
      run: cmake --build build && mkdir artifact && mv build/maniac artifact
      shell: bash
    - name: Upload artifact
      uses: actions/upload-artifact@v1.0.0
      with:
        name: build-windoes-latest
        path: artifact
